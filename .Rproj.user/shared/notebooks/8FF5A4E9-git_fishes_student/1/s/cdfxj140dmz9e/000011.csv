"0","#permutation analysis for the ""acantho"" species activity"
"0",""
"0","#create an empty tibble to contain the permutation results"
"0","#the 'stat' column will hold the t-statistic for the permutation"
"0","#the 'extreme' column will record whether this t-stat is greater than the true data's t-stat"
"0","samp_dist <- tibble(stat = rep(F,5000), extreme = rep(F,5000))"
"0",""
"0","for(i in 1:500){"
"0","  #create a temporary data set in which the treatment column is shuffled, and keep only the data for ""acantho"" species"
"0","  temp_data <- data_clean %>% mutate(treatment = sample(treatment, length(treatment), replace = F)) %>% filter(species == ""acantho"")"
"0","  #run a t-test on this permutation, and save the t-statistic in the samp_dist object"
"0","  samp_dist$stat[i] <- t.test(temp_data$activity[temp_data$treatment == ""CO2""],temp_data$activity[temp_data$treatment == ""control""],var.equal=T)$statistic"
"0","  #record whether this permutation's t-stat is greater than the data's t-stat"
"0","  samp_dist$extreme[i] <- (abs(samp_dist$stat[i]) > abs(results_activity$T.stat[1]))"
"0","}"
"0",""
"0","#this proportion is our p-value for the permutation analysis"
"0","p <- length(which(samp_dist$extreme)) / length(which(!samp_dist$extreme))"
"0","p"
"1","[1]"
"1"," 0.033"
"1","
"
